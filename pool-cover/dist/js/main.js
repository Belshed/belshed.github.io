
'use strict';document.addEventListener('DOMContentLoaded',()=>{const navLinks=document.querySelectorAll('.js-nav-link');const header=document.querySelector('.header');const dropdownItems=document.querySelectorAll('.js-dropdown');const tabsTriggers=document.querySelectorAll('.js-tab-title');const tabs=document.querySelectorAll('.js-tab');const burger=document.querySelector('.js-burger');const menu=document.querySelector('.js-menu');const mobileFilter=document.querySelector('.js-filter');const mobileFilterTrigger=document.querySelectorAll('.js-filter-trigger');const navLevelLinks=document.querySelectorAll('.js-nav-level-link');const popups=document.querySelectorAll('.popup');const popupTriggers=document.querySelectorAll('.js-popup-trigger');const popupCloseTriggers=document.querySelectorAll('.js-popup-close');const telInputs=document.querySelectorAll('input[type="tel"]');const colorPickers=document.querySelectorAll('.js-color-picker');const galleryScale=document.querySelectorAll('.js-gallery-scale');const isExists=element=>{if(typeof(element)=='string'){return document.querySelector(element)?true:false;}
else if(typeof(element)=='object'){return element?true:false;}}
const navLevelLinkClick=()=>{event.preventDefault();let target=event.target;if(!target.classList.contains('js-nav-return-link')){target.parentNode.querySelector('.nav__list_inner').classList.add('active');}
else{target.parentNode.parentNode.classList.remove('active');}}
const setNavLinkActive=()=>{navLinks.forEach(link=>{link.parentNode.classList.remove('active');if(window.location.href.indexOf(link.getAttribute('href'))>-1){link.parentNode.classList.add('active');}});}
const scrollHandler=()=>{window.pageYOffset>60?header.classList.add('header_fixed'):header.classList.remove('header_fixed');}
const maskInit=()=>{const setCursorPosition=(pos,elem)=>{elem.focus();if(elem.setSelectionRange)elem.setSelectionRange(pos,pos);else if(elem.createTextRange){var range=elem.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select();}}
function mask(event){var matrix="+7 (___) ___ __ __",i=0,def=matrix.replace(/\D/g,""),val=this.value.replace(/\D/g,"");if(def.length>=val.length)val=def;this.value=matrix.replace(/./g,function(a){return/[_\d]/g.test(a)&&i<val.length?val.charAt(i++):i>=val.length?"":a;});if(event.type=="blur"){if(this.value.length==2)this.value="";}
else{setCursorPosition(this.value.length,this);}};telInputs.forEach(input=>{input.addEventListener("input",mask,false);input.addEventListener("focus",mask,false);input.addEventListener("blur",mask,false);});}
const resizeHandler=()=>{if(window.innerWidth>=740){toggleMenu(false);if(isExists(mobileFilter)){toggleFilter(false);}}}
const openPopup=selector=>{const targetPopup=document.querySelector(selector);targetPopup.classList.add('active');return targetPopup;}
const openPopupByTrigger=()=>{let target=event.target;while(!target.classList.contains('js-popup-trigger')){target=target.parentNode;}
openPopup(target.dataset.target);}
const closePopups=()=>{popups.forEach(popup=>{popup.classList.remove('active');if(isExists(popup.querySelector('video'))){popup.querySelector('video').pause();}});}
const dropdownSelectInit=(dropdownItems)=>{const createOptionPopupItem=(option,index,item)=>{const dropdownPopupItem=document.createElement('li');dropdownPopupItem.classList.add('dropdown__item');dropdownPopupItem.setAttribute('tabindex',0);dropdownPopupItem.innerHTML=setTriggerText(item,option);dropdownPopupItem.dataset.index=index;return dropdownPopupItem;}
const setTriggerText=(item,data)=>{return item.dataset.triggerVal=='text'?data.textContent:data.innerHTML;}
dropdownItems.forEach(item=>{const options=item.querySelectorAll('.js-dropdown-select li');options[0].dataset.selected=true;const dropdownTrigger=document.createElement('button');dropdownTrigger.classList.add('button','dropdown__trigger','js-dropdown-trigger');dropdownTrigger.setAttribute('type','button');const dropdownText=document.createElement('span');dropdownText.classList.add('dropdown__trigger-text');dropdownText.innerHTML=options[0].textContent;const dropdownPopupList=document.createElement('ul');dropdownPopupList.classList.add('dropdown__list');const dropdownSelect=document.createElement('select');dropdownSelect.setAttribute('name',item.dataset.selectName)
options.forEach((option,index)=>{if(option.dataset.value!='none'&&!option.hasAttribute('hidden')){const dropdownPopupItem=createOptionPopupItem(option,index,item);dropdownPopupList.appendChild(dropdownPopupItem);const dropdownOption=document.createElement('option');dropdownOption.innerHTML=option.textContent;dropdownOption.value=option.dataset.value;dropdownSelect.appendChild(dropdownOption);dropdownPopupItem.addEventListener('click',()=>{let targetItem=event.target;while(targetItem.tagName!='LI'){targetItem=targetItem.parentNode;}
targetItem.dataset.selected=true;const targetItemIndex=parseInt(targetItem.dataset.index);dropdownSelect.querySelectorAll('option')[targetItemIndex-1].selected=true;dropdownText.innerHTML=dropdownPopupItem.textContent;});}});dropdownTrigger.appendChild(dropdownText);item.appendChild(dropdownTrigger);item.appendChild(dropdownPopupList);item.appendChild(dropdownSelect);dropdownTrigger.addEventListener('click',()=>{event.stopImmediatePropagation();let target=event.target;while(!target.classList.contains('js-dropdown-trigger')){target=target.parentNode;}
target.classList.toggle('active');dropdownPopupList.classList.toggle('active');document.addEventListener('click',()=>{const target=event.target;event.stopImmediatePropagation();if(!target.parentNode.classList.contains('js-dropdown-trigger')&&!target.classList.contains('js-dropdown-trigger')){document.querySelectorAll('.dropdown__list').forEach(item=>item.classList.remove('active'));document.querySelectorAll('.js-dropdown-trigger').forEach(item=>item.classList.remove('active'));}});});item.querySelector('select').addEventListener('change',()=>{const targetOption=event.target;options.forEach(option=>{if(option.selected)dropdownText.innerHTML=setTriggerText(item,option);});});});}
const toggleMenu=(state=null)=>{menu.style.top=header.getBoundingClientRect().height+'px';if(state==null){return()=>{burger.classList.toggle('active');menu.classList.toggle('active');header.classList.toggle('menu-opened');};}
else{state?burger.classList.add('active'):burger.classList.remove('active');state?menu.classList.add('active'):menu.classList.remove('active');state?header.classList.add('menu-opened'):header.classList.remove('menu-opened');}}
const toggleFilter=(state=null)=>{mobileFilter.style.top=header.getBoundingClientRect().height+'px';if(state==null){return()=>{mobileFilter.classList.toggle('active');};}
else{state?mobileFilter.classList.add('active'):mobileFilter.classList.remove('active');}}
if(isExists('.js-item-swiper')){const itemSwiperThumbs=new Swiper('.js-item-thumbs-swiper',{spaceBetween:10,followFinger:false,breakpoints:{1020:{slidesPerView:5,},800:{slidesPerView:4,},300:{slidesPerView:3,}}});const itemSwiper=new Swiper('.js-item-swiper',{slidesPerView:1,loop:true,spaceBetween:15,navigation:{prevEl:'.item-slider__control_prev',nextEl:'.item-slider__control_next',},thumbs:{swiper:itemSwiperThumbs}});}
if(isExists('.js-hero-swiper')){const heroSwiper=new Swiper('.js-hero-swiper',{loop:true,preloadImages:false,speed:1000,lazy:{loadOnTransitionStart:true,loadPrevNext:true,},autoplay:{delay:3000,},pagination:{el:'.swiper-pagination',type:'bullets',clickable:true,},navigation:{prevEl:'.hero__control.hero__control_prev',nextEl:'.hero__control.hero__control_next',}});}
if(isExists('.js-hits-swiper')){const hitsSwiper=new Swiper('.js-hits-swiper',{breakpoints:{1080:{slidesPerView:4,spaceBetween:30,},850:{slidesPerView:3,spaceBetween:20,},530:{slidesPerView:2,spaceBetween:15,},300:{slidesPerView:1,spaceBetween:15,}},navigation:{prevEl:'.hits__control.hits__control_prev',nextEl:'.hits__control.hits__control_next',}});}
if(isExists('.js-faq-item')){const faqItems=document.querySelectorAll('.js-faq-item');faqItems.forEach(item=>{item.querySelector('.js-faq-trigger').addEventListener('click',()=>{item.classList.toggle('active');});});}
if(isExists(dropdownItems[0])){dropdownSelectInit(dropdownItems);}
if(isExists(tabsTriggers[0])&&isExists(tabs[0])){tabsTriggers.forEach(tabTrigger=>{tabTrigger.addEventListener('click',()=>{tabs.forEach(item=>item.classList.remove('active'));tabsTriggers.forEach(item=>item.classList.remove('active'));event.target.classList.add('active');const tabsArr=[...tabs];const targetTab=tabsArr.filter(item=>item.dataset.index==tabTrigger.dataset.index)[0];targetTab.classList.add('active');});});}
if(isExists(galleryScale[0])){galleryScale.forEach(galleryItem=>{if(!galleryItem.classList.contains('gallery-item_video')){galleryItem.style.cursor='zoom-in';}
galleryItem.addEventListener('click',()=>{event.preventDefault();let target=event.target;while(!target.classList.contains('js-gallery-scale')){target=target.parentNode;}
const mediaPopup=openPopup('.js-popup-gallery');const mediaPopupImg=mediaPopup.querySelector('.js-popup-media');mediaPopupImg.setAttribute('src',target.getAttribute('href'))});});}
if(isExists(telInputs[0])){maskInit();}
if(isExists(colorPickers[0])){colorPickers.forEach(picker=>{picker.addEventListener('click',()=>{colorPickers.forEach(item=>item.classList.remove('active'));picker.classList.add('active');});});}
window.addEventListener('scroll',scrollHandler);window.addEventListener('resize',resizeHandler);navLevelLinks.forEach(link=>link.addEventListener('click',navLevelLinkClick));mobileFilterTrigger.forEach(trigger=>trigger.addEventListener('click',toggleFilter()));popupTriggers.forEach(trigger=>trigger.addEventListener('click',openPopupByTrigger));popupCloseTriggers.forEach(trigger=>trigger.addEventListener('click',event=>{event.stopPropagation();if(event.target.classList.contains('js-popup-close')){closePopups();}}));burger.addEventListener('click',toggleMenu());setNavLinkActive();});