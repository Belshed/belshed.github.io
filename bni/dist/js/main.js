
(function(){'use strict';document.addEventListener('DOMContentLoaded',()=>{const dropdownItems=document.querySelectorAll('.js-dropdown');const dropdownSelectInit=dropdownItems=>{const createOptionPopupItem=(option,index)=>{const dropdownPopupItem=document.createElement('li');dropdownPopupItem.classList.add('dropdown__item');dropdownPopupItem.setAttribute('tabindex',0);dropdownPopupItem.innerHTML=option.innerHTML;dropdownPopupItem.dataset.index=index;return dropdownPopupItem;};const setTriggerText=(item,data)=>{return item.dataset.triggerVal=='text'?data.textContent:data.innerHTML;};dropdownItems.forEach(item=>{const options=item.querySelectorAll('.js-dropdown-select li');options[0].dataset.selected=true;const dropdownTrigger=document.createElement('button');dropdownTrigger.classList.add('button','dropdown__trigger','js-dropdown-trigger');dropdownTrigger.setAttribute('type','button');const dropdownText=document.createElement('span');dropdownText.classList.add('dropdown__trigger-text');dropdownText.innerHTML=setTriggerText(item,options[0]);const dropdownPopupList=document.createElement('ul');dropdownPopupList.classList.add('dropdown__list');const dropdownSelect=document.createElement('select');dropdownSelect.setAttribute('name',item.dataset.selectName);options.forEach((option,index)=>{if(option.dataset.value!='none'&&!option.hasAttribute('hidden')){const dropdownPopupItem=createOptionPopupItem(option,index);dropdownPopupList.appendChild(dropdownPopupItem);const dropdownOption=document.createElement('option');dropdownOption.innerHTML=option.textContent;dropdownOption.value=option.dataset.value;dropdownSelect.appendChild(dropdownOption);dropdownPopupItem.addEventListener('click',()=>{let targetItem=event.target;while(targetItem.tagName!='LI'){targetItem=targetItem.parentNode;}
targetItem.dataset.selected=true;let targetItemIndex=parseInt(targetItem.dataset.index);dropdownSelect.querySelectorAll('option')[targetItemIndex-1].selected=true;dropdownText.innerHTML=setTriggerText(item,dropdownPopupItem);});}});dropdownTrigger.appendChild(dropdownText);item.appendChild(dropdownTrigger);item.appendChild(dropdownPopupList);item.appendChild(dropdownSelect);dropdownTrigger.addEventListener('click',()=>{event.stopImmediatePropagation();let target=event.target;while(!target.classList.contains('js-dropdown-trigger')){target=target.parentNode;}
target.classList.toggle('active');dropdownPopupList.classList.toggle('active');document.addEventListener('click',()=>{const target=event.target;event.stopImmediatePropagation();if(!target.parentNode.classList.contains('js-dropdown-trigger')&&!target.classList.contains('js-dropdown-trigger')){document.querySelectorAll('.dropdown__list').forEach(item=>item.classList.remove('active'));document.querySelectorAll('.js-dropdown-trigger').forEach(item=>item.classList.remove('active'));}});});item.querySelector('select').addEventListener('change',()=>{const targetOption=event.target;options.forEach(option=>{if(option.selected)dropdownText.innerHTML=setTriggerText(item,option);});});});};dropdownSelectInit(dropdownItems);});}());