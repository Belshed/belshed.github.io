
(function(){'use strict';document.addEventListener('DOMContentLoaded',()=>{const forms=document.querySelectorAll('form');const formLabels=document.querySelectorAll('.js-form-label');const telInputs=document.querySelectorAll('input[type="tel"]');const popupCloseTriggers=document.querySelectorAll('.js-popup-close');const popupTriggers=document.querySelectorAll('.js-popup-trigger');const popups=document.querySelectorAll('.popup');const isExists=element=>{if(typeof(element)=='string'){return document.querySelector(element)?true:false;}
else if(typeof(element)=='object'){if(Array.isArray(element)){return element[0]?true:false;}
else if(NodeList.prototype.isPrototypeOf(element)){return element[0]?true:false;}
return element?true:false;}};const switchLabelFocus=()=>{const label=event.target.parentNode;const eventType=event.type;eventType=='focus'?label.classList.add('form__label_focused'):label.classList.remove('form__label_focused');};const openPopup=selector=>{closePopups();const targetPopup=document.querySelector(selector);targetPopup.classList.add('active');toggleScroll(false);return targetPopup;};const openPopupByTrigger=()=>{const target=event.target;while(!target.classList.contains('js-popup-trigger')){target=target.parentNode;}
openPopup(target.dataset.target);};const closePopups=()=>{popups.forEach(function(popup){popup.classList.remove('active');if(isExists(popup.querySelector('video'))){popup.querySelector('video').pause();}});toggleScroll(true);};const toggleScroll=(state=null)=>{const body=document.querySelector('body');const html=document.querySelector('html');if(state!=null){state?body.classList.remove('no-scroll'):body.classList.add('no-scroll');state?html.classList.remove('no-scroll'):html.classList.add('no-scroll');}
else{body.classList.toggle('no-scroll');html.classList.toggle('no-scroll');}};const formSubmitHandler=async()=>{event.preventDefault();const targetForm=event.target;const formInputs=targetForm.querySelectorAll('input');formInputs.forEach(input=>{switch(input.getAttribute('type')){case'tel':if(input.value.length<18){input.parentNode.classList.add('form__label_invalid');}
break;case'text':if(input.value.length<1){input.parentNode.classList.add('form__label_invalid');}
break;}
input.addEventListener('input',()=>{input.parentNode.classList.remove('form__label_invalid');});});if(targetForm.querySelectorAll('.form__label_invalid').length){targetForm.querySelectorAll('.form__label_invalid input')[0].focus();return;}
const data=new FormData(targetForm);openPopup('.js-popup-success');targetForm.reset();setTimeout(()=>{closePopups();},2000);};const maskInit=()=>{const setCursorPosition=(pos,elem)=>{elem.focus();if(elem.setSelectionRange)elem.setSelectionRange(pos,pos);else if(elem.createTextRange){let range=elem.createTextRange();range.collapse(true);range.moveEnd("character",pos);range.moveStart("character",pos);range.select();}};function mask(event){let matrix="+7 (___) ___ __ __",i=0,def=matrix.replace(/\D/g,""),val=this.value.replace(/\D/g,"");if(def.length>=val.length)val=def;this.value=matrix.replace(/./g,function(a){return/[_\d]/g.test(a)&&i<val.length?val.charAt(i++):i>=val.length?"":a;});if(event.type=="blur"){if(this.value.length==2)this.value="";}
else{setCursorPosition(this.value.length,this);}}
telInputs.forEach(input=>{input.addEventListener("input",mask,false);input.addEventListener("focus",mask,false);input.addEventListener("blur",mask,false);});};if(isExists(formLabels)){formLabels.forEach(label=>{label.querySelector('input').addEventListener('focus',switchLabelFocus);label.querySelector('input').addEventListener('blur',switchLabelFocus);});}
if(isExists(popupCloseTriggers)){popupCloseTriggers.forEach(trigger=>{trigger.addEventListener('click',()=>{event.stopPropagation();if(event.target.classList.contains('js-popup-close')){closePopups();}});});}
if(isExists(popupTriggers)){popupTriggers.forEach(trigger=>{trigger.addEventListener('click',openPopupByTrigger);});}
if(isExists(forms)){forms.forEach(form=>{form.addEventListener('submit',formSubmitHandler);});}
maskInit();});}());
//# sourceMappingURL=main.js.map
